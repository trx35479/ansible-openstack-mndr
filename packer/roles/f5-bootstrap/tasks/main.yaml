---
- name: Create the node
  bigip_node:
    host: '{{ ansible_default_ipv4.address }}'
    description: 'MNDR Node'
    name: '{{ ansible_fqdn }}'
    password: '{{ password }}'
    server: '{{ server }}'
    user: '{{ username }}'
    server_port: '{{ api_port }}'
    validate_certs: no

- name: Add node to the Pool
  bigip_pool_member:
    description: MNDR Application
    host: '{{ ansible_default_ipv4.address }}' # New IP address to be added to the pool
    name: '{{ ansible_fqdn }}' # Hostname of the new node to be added to the pool
    password: '{{ password }}' # F5 password
    pool: '{{ pool_name }}' # Pool name where the new node belong
    port: '{{ dia_port }}' # port that the new member will listen to
    server: '{{ server }}' #F5 server IP
    user: '{{ username }}' # F5 server username to use on login
    server_port: '{{ api_port }}'
    validate_certs: no
